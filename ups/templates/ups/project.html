{% extends "ups/base.html" %}
{% load guardian_tags %}
{% load bootstrap3 %}

{% block header %}

    {% get_obj_perms request.user for project as "pr_view_perms" %}

    <h2 style="display:inline-block">{{ project }}</h2>
    <small style="display:inline-block">
        {% if "edit_project" in pr_view_perms %}
            <a href="{% url 'ups:edit_project' project.id %}">Edit</a>
        {% endif %}
    </small>

    <h5>{{ project.desc|linebreaks }}</h5>

{% endblock header %}

{% block content %}

    <script type="text/javascript">
        function checker(box_id, body_id) {
            var box  = document.getElementById(box_id);
            var body = document.getElementById(body_id);
            if   ( box.checked == false )
                 { box.checked = true;  body.style.background = '#dff0d8'; }
            else { box.checked = false; body.style.background = '';}
        }

        function select_all(box_name, body_name, state) {
            var color = ''; if ( state == true ) { var color = '#dff0d8'; }
            var boxes  = document.getElementsByName(box_name);
            var bodies = document.getElementsByClassName(body_name);
            for (i = 0; i < boxes.length;  i++) { boxes[i].checked = state; }
            for (i = 0; i < bodies.length; i++) { bodies[i].style.background = color; }
        }
    </script>

    {% get_obj_perms request.user for project as "pr_view_perms" %}

    <form method='post' action="{% url 'ups:project' project.id %}">
        {% csrf_token %}

        <!-- Nav tabs -->
        <ul class="nav nav-tabs nav-justified" role="tablist">
            <li role="presentation" class="active">
                <a href="#updates" aria-controls="updates" role="tab" data-toggle="tab">
                    <h4>Updates</h4>
                </a>
            </li>

            <li role="presentation">
                <a href="#servers" aria-controls="servers" role="tab" data-toggle="tab">
                    <h4>Servers</h4>
                </a>
            </li>
        </ul>

        <!-- Tab panes -->
        <div class="tab-content">
            <div role="tabpanel" class="tab-pane fade in active" id="updates">{% include "ups/project_updates.html" %}
            </div>
            <div role="tabpanel" class="tab-pane fade" id="servers">{% include "ups/project_servers.html" %}</div>
        </div>

        <hr>

        {% if "run_command" in pr_view_perms %}

            {% buttons %}
                <input type="submit" class="btn btn-primary" name="select_test"     value="Show selected"/>
                <input type="submit" class="btn btn-primary" name="select_upload"   value="Upload"/>
                <input type="submit" class="btn btn-primary" name="select_check"    value="Check updates on servers"/>
                <input type="submit" class="btn btn-primary" name="select_schedule" value="Check scheduled updates"/>
            {% endbuttons %}

        {% endif %}

        {% buttons %}
            <input type="submit" name="cancel" value="Go to Projects" class="btn btn-warning"/>
        {% endbuttons %}
    </form>

{% endblock content %}