{% extends "ups/base.html" %}
{% load guardian_tags %}
{% load bootstrap3 %}

{% block header %}

    {% get_obj_perms request.user for project as "pr_view_perms" %}

    <br>

    <div class="row">
        <div class="col-md-2">
            <h2 style="display:inline-block">{{ project }}</h2>
            <small style="display:inline-block">
                {% if "edit_project" in pr_view_perms %}
                <a href="{% url 'ups:edit_project' project.id %}">Edit</a>
                {% endif %}
            </small>
        </div>
        <div class="col-md-6"><h5>{{ project.desc|linebreaks }}</h5></div>
    </div>

{% endblock header %}

{% block content %}

    <script type="text/javascript">
        function checker(box_id, body_id) {
            var box  = document.getElementById(box_id);
            var body = document.getElementById(body_id);
            if   ( box.checked == false )
                 { box.checked = true;  body.style.background = '#dff0d8'; }
            else { box.checked = false; body.style.background = '';}
        }

        function select_all(box_name, body_name, state) {
            var color = ''; if ( state == true ) { var color = '#dff0d8'; }
            var boxes  = document.getElementsByName(box_name);
            var bodies = document.getElementsByClassName(body_name);
            for (i = 0; i < boxes.length;  i++) { boxes[i].checked = state; }
            for (i = 0; i < bodies.length; i++) { bodies[i].style.background = color; }
        }

        function topFunction() {
            document.body.scrollTop = 0; // For Chrome, Safari and Opera
            document.documentElement.scrollTop = 0; // For IE and Firefox
        }

        function SelectValidation() {

            var selected = false;

            var updates =  document.getElementsByName('selected_updates');
            var servers =  document.getElementsByName('selected_servers');

            for (i = 0; i < updates.length; i++) { if (updates[i].checked) { selected = true; } }
            for (i = 0; i < servers.length; i++) { if (servers[i].checked) { selected = true; } }

            if (selected == false) {
                alert('None selected.');
                return false;
            }

        }

        function CopyValidation() {

            var selected_updates = false;
            var selected_servers = false;

            var updates =  document.getElementsByName('selected_updates');
            var servers =  document.getElementsByName('selected_servers');

            for (i = 0; i < updates.length; i++) { if (updates[i].checked) { selected_updates = true; } }
            for (i = 0; i < servers.length; i++) { if (servers[i].checked) { selected_servers = true; } }

            if (selected_updates == false) {
                alert('Update(s) not selected.');
                return false;
            }

            if (selected_servers == false) {
                alert('Server(s) not selected.');
                return false;
            }

        }
    </script>

    {% get_obj_perms request.user for project as "pr_view_perms" %}

    <form method='post' action="{% url 'ups:project' project.id %}" id="selector">
        {% csrf_token %}

        <!-- Nav tabs -->
        <ul class="nav nav-tabs nav-justified" role="tablist">
            <li role="presentation" class="active">
                <a href="#updates_servers" aria-controls="updates_servers" role="tab" data-toggle="tab">
                    <h4>Updates & Servers</h4>
                </a>
            </li>

            <li role="presentation">
                <a href="#history" aria-controls="history" role="tab" data-toggle="tab">
                    <h4>History</h4>
                </a>
            </li>

        </ul>

        <!-- Tab panes -->
        <div class="tab-content">
            <div role="tabpanel" class="tab-pane fade in active" id="updates_servers">
                {% include "ups/project_servers_updates.html" %}
            </div>
            <div role="tabpanel" class="tab-pane fade" id="history">{% include "ups/project_history.html" %}</div>
        </div>

    {% include "ups/bottom_panel.html" %}

    </form>

{% endblock content %}